(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{645:function(e,t,s){"use strict";s.r(t);var a=s(11),n=Object(a.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h2",{attrs:{id:"websocket-与传统的-http-有什么优势"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#websocket-与传统的-http-有什么优势"}},[e._v("#")]),e._v(" websocket 与传统的 http 有什么优势")]),e._v(" "),s("ul",[s("li",[e._v("客户端与服务端只需要一个 TCP 连接，比 http 进行长轮询使用更少的连接")]),e._v(" "),s("li",[e._v("websocket 服务端可以推送数据到客户端")]),e._v(" "),s("li",[e._v("更轻量的协议头，减少数据传输量")])]),e._v(" "),s("h2",{attrs:{id:"websocket-协议升级是什么-简单描述一下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#websocket-协议升级是什么-简单描述一下"}},[e._v("#")]),e._v(" websocket 协议升级是什么，简单描述一下")]),e._v(" "),s("p",[e._v("首先，websocket 连接必须由客户端发起，因为请求协议是一个标准的 http 请求，格式如下:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("GET ws://localhost:3000/ws/chat HTTP/1.1\nHost: localhost\nUpgrade: websocket\nConnection: Upgrade\nOrigin: http://localhost:3000\nSec-Websocket-Key: client-random-string\nSec-Websocket-version: 13\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("p",[e._v("该请求和普通请求有以下几点不同:")]),e._v(" "),s("ul",[s("li",[e._v("GET 请求的地址不是类似/path/，而是以 ws:// 开头的地址")]),e._v(" "),s("li",[e._v("请求头 Upgrade: websocket 和 Connection: Upgrade 表示这个连接将要被转换为 WebSocket 连接")]),e._v(" "),s("li",[e._v("Sec-WebSocket-Key 是用于标识这个连接，并非用于加密数据")]),e._v(" "),s("li",[e._v("Sec-WebSocket-Version 指定了 WebSocket 的协议版本")])]),e._v(" "),s("p",[e._v("随后，如果服务器接收该请求，就会返回如下响应:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("HTTP/1.1 101 Switching Protocols\nUpgrade: websocket\nConnection: Upgrade\nSec-WebSocket-Accept: server-random-string\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("该响应代码 101 表示本次连接的 HTTP 协议即将被更改，更改后的协议就是 Upgrade: websocket 指定的 WebSocket 协议")])])}),[],!1,null,null,null);t.default=n.exports}}]);